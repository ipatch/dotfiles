#############################
#
# ~ tmux.conf ~ for Chris Jones
# @ipatch - github
# @truckmonth - twitter
# 


# the default "prefix" key in tmux is `C-b` = <Control>+b
# the below configuration will ubind `C-b`
unbind C-b

# the below configuration will reassign the `prefix` key.
# NOTE: `-g` flag makes the `prefix` global to ALL tmux sessions.
set -g prefix C-s

# NOTE: `bind-key` refers to the `prefix` key, ie. press `C-s` then `r` to reload tmux.conf 
# bind-key u split-window -h
#############################
# NOTE: `display` is short for `display-message`
# NOTE: `bind` is short for `bind-key`
##
bind r source-file ~/.tmux.conf \; display "~/.tmux.conf reloaded"

# Neovim recommends the below `escape` time setting
set -sg escape-time 10

# Note - the below "-n" option when creating a key-binding
# creates a key-binding without having to use the "prefix" key

# TODO: use a different meta key for moving around between panes.
# ie. don't want to lose `C-l` functionality to clear the screen!

# bind-key -n C-h select-pane -L
# bind-key -n C-j select-pane -D
# bind-key -n C-k select-pane -U
# bind-key -n C-l select-pane -R

# Note - "set-option" controls the look / feel of tmux.
set -sa terminal-overrides ",xterm*:Tc"

# NOTE: the below setting should allow True Color, ie. 24 bit color
# within tmux, according to the Arch wiki
# https://wiki.archlinux.org/index.php/Tmux

#############################
# Status line settings
##
# Note - "set" is short for "set-option", it is
# an internal alias within tmux.
set -g status-bg '#3e93b2'
set -g status-fg '#01070a'
set -g status-justify centre # center the window list in status line
# Note - the below option sets / displays the tmux
# session name up to 50 characters long.
# It can be seen in the lower left of the tmux
# status bar. ;)
set -g status-left-length 50

#############################
# Winow / pane splitting
##
bind - split-window -v -c "#{pane_current_path}" # split pane and create in path
bind \ split-window -h -c "#{pane_current_path}" # split pane and create in path

# bind -n S-Left resize-pane -L 2
# bind -n S-Right resize-pane -R 2
# bind -n S-Down resize-pane -D 1
# bind -n S-Up resize-pane -U 1

bind -n C-Left resize-pane -L 10
bind -n C-Right resize-pane -R 10
bind -n C-Down resize-pane -D 5
bind -n C-Up resize-pane -U 5

bind c new-window -c '#{pane_current_path}'

#############################
# NOTE: `setw` is short for `set-window-option`
##
setw -g base-index 1
setw -g renumber-windows on

# Note - the below key-binding is not working.
# bind-key C-j choose-tree

# Note - add the below configuration for pair programming :)
# set -g mouse-resize-pane on 
# set -g mouse-select-pane on 
# set -g mouse-select-window on 
# set -g default-terminal <screen-256color>;
# set -g history-limit 1000

# try and get copy / paste working with macOS Sierra
set -g default-shell $SHELL
# set -g default-command "reattach-to-user-namespace -l ${SHELL}"

# Vim style navigation in copy mode
setw -g mode-keys vi

# setup 'v' to begin selection, just like Vim
# bind-key -t vi-copy v begin-selection

# Setup 'y' to yank (copy), just like Vim
# bind-key -t vi-copy y copy-pipe "reattach-to-user-namespace pbcopy"

# Update default binding of `Enter` to also use copy-pipe
# unbind -t vi-copy Enter
# bind-key -t vi-copy Enter copy-pipe "reattach-to-user-namespace pbcopy"

# Bind ']' to use pbbaste
# bind ] run "reattach-to-user-namespace pbpaste | tmux load-buffer - && tmux paste-buffer"

set -g mouse on

# Toggle the visibility of the tmux status bar
bind -n S-Up set-option status #shift+up-arrow Combo

#############################
# Set keys for easier window management
##
# Create a new window within the tmux session
bind -n S-down new-window -c "#{pane_current_path}"
# goto the previous window
bind -n S-left prev
# goto the next window
bind -n S-right next
# move the current window to the left
bind -n C-left swap-window -t -1
# move the current window to the right
bind -n C-right swap-window -t +1

#############################
# SSH - adapting tmux to work with term title bars
##
set -g set-titles on          # set-titles-string      
set -g set-titles-string "#{session_name} - #T"

# rename window / pane based on what is currently running.
# NOTE: the below setting doesn't play nice with `Terminal.app`
set -g automatic-rename on

set -g status-left '#S '      # modify the default left status bar

bind C-k clear-history        # Clear the scrollback

set -g history-limit 20000    # Scrollback for days (default is 2000)

#############################
# Activity Notifications / Monitoring
##
set -g monitor-activity on # highlight windows that have unseen activity
set -g visual-activity off # don't show a notification when there is activity in a window

#############################
# Style panes
##
#set inactive/active window styles
set -g window-style 'fg=colour247,bg=colour236'
set -g window-active-style 'fg=colour250,bg=black'

# set the pane border colors 
set -g pane-border-fg colour250
set -g pane-border-bg colour236
set -g pane-active-border-fg colour250 
set -g pane-active-border-bg colour250

#############################
# Experimenting with `reattach-to-user-namespace`
##
set -g default-command "reattach-to-user-namespace -l /bin/fish"
